"use strict";const newOrdersWrapper=document.querySelector(".new__orders__fields__container"),ordersForm=document.querySelector(".new__orders__form"),customerNameField=document.querySelector(".customer__name__field input"),tableBody=document.querySelector("tbody");newOrdersWrapper.addEventListener("click",(function(e){"new__order__fields"===e.target.parentNode.className&&"button"===e.target.localName&&this.removeChild(e.target.parentNode)}));const getProductName=function(e){const t=e.value,r=new XMLHttpRequest;r.open("POST","/getProductDetails"),r.setRequestHeader("Content-Type","application/json"),r.responseType="json",r.onload=function(){const t=r.response.unit;if(t){e.parentNode.nextElementSibling.children[1].value=t;const n=e.parentNode.parentNode,o=n.children[2].children[1].value;if(o){n.children[3].children[1].value=Number(o)*r.response.price}}},r.onerror=()=>console.error("Internal Server Error"),r.send(JSON.stringify({name:t}))},calcTotalPrice=e=>{const t=Number(e.value),r={name:e.parentNode.parentNode.children[0].children[1].value},n=new XMLHttpRequest;n.open("POST","/getProductDetails"),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=()=>{if(200===n.status){const r=n.response.price;r&&(e.parentNode.nextElementSibling.children[1].value=r*t)}else console.error(n.statusText)},n.onerror=()=>console.error("Internal Server Error"),n.send(JSON.stringify(r))};ordersForm.addEventListener("submit",(e=>{e.preventDefault();const t=newOrdersWrapper.children,r=[];for(let e=0;e<t.length;e++){const n=t[e].children,o=new Array;for(let e=0;e<n.length-1;e++)o.push(n[e].children[1].value),n[e].children[1].value=0!==e?"":"Product name";r.push(o)}const n=JSON.stringify({customer:customerNameField.value,orders:r});customerNameField.value="";for(let e=0;e<t.length-1;e++)newOrdersWrapper.removeChild(newOrdersWrapper.firstElementChild);(async()=>{const e={mode:"same-origin",cache:"no-cache",method:"POST",body:n,headers:{"Content-Type":"application/json"}},t=await fetch("/getOrders",e);if(200===t.status)return t.json();throw Error("Did not get the expected result")})().then((e=>{e.orders.forEach((e=>{const t=tableBody.children.length,r=`<tr id="order--${e[0]}"><td>${t+1}</td><td>${e[1]}</td><td>${e[2]}</td>\n            <td>${e[3]} (${e[4]})</td><td>${e[5]}</td><td>${e[6]}</td><td><button class="order__remove__btn btn">Remove</button></td></tr>`;tableBody.insertAdjacentHTML("beforeend",r)}))})).catch(console.error)})),tableBody.addEventListener("click",(function(e){if(e.target.classList.contains("order__remove__btn")){const t=e.target.parentNode.parentNode.id.split("--")[1];(async()=>{const e={mode:"same-origin",method:"post",body:JSON.stringify({id:+t}),headers:{"Content-Type":"application/json"},cache:"default"},r=await fetch("/removeOrder",e);if(200===r.status)return r.text();throw Error("Did not get the expected result")})().then((e=>console.log(e))).catch(console.error),this.removeChild(e.target.parentNode.parentNode);const r=this.children;for(let e=0;e<r.length;e++)r[e].children[0].textContent=e+1}}));
//# sourceMappingURL=orders.js.map
