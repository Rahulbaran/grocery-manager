"use strict";const dropArea=document.querySelector(".dropArea"),avatarForm=document.querySelector(".dropArea form"),fileField=document.getElementById("avatar--file"),uploadErrorMsg=document.querySelector(".dropArea .upload__error__msg");["dragover","dragenter","dragleave","drop"].forEach((e=>{dropArea.addEventListener(e,(e=>{e.preventDefault()}))})),["dragover","dragenter"].forEach((e=>{dropArea.addEventListener(e,(()=>{avatarForm.classList.add("highlight")}))})),["dragleave","drop"].forEach((e=>{dropArea.addEventListener(e,(()=>{avatarForm.classList.remove("highlight")}))}));const updateMsg=(e,t)=>{uploadErrorMsg.textContent=e,uploadErrorMsg.style.color=t},uploadAvatarFunc=e=>{const t=["image/jpeg","image/jpg","image/png","image/gif"];if(1===e.length&&e[0].size<=16777216&&t.includes(e[0].type)){const t=new FormData;t.append("avatar",e[0]);(async()=>{const e={method:"post",mode:"same-origin",cache:"no-cache",body:t},a=await fetch("/uploadAvatar",e);if(a.ok&&200===a.status)return await a.json();uploadErrorMsg.textContent="â˜¹ Sorry something went wrong"})().then((e=>{avatarForm.lastElementChild.matches("img")&&avatarForm.removeChild(avatarForm.lastElementChild);const t=document.createElement("img");t.src=`../static/user-images/${e.pic}`,avatarForm.append(t),updateMsg("Your profile pic has been updated","hsl(220,100%,55%)")})).catch(console.error)}else e[0].size>16777216?updateMsg("file size is greater than 16 MB","hsl(5, 100%, 50%)"):t.includes(e[0].type)?updateMsg("Only one file is allowed to upload","hsl(5, 100%, 50%)"):updateMsg("file in jpg/png/gif format is only allowed","hsl(5, 100%, 50%)")};dropArea.addEventListener("drop",(e=>{const t=[...e.dataTransfer.files];uploadAvatarFunc(t)})),fileField.addEventListener("change",(function(){uploadAvatarFunc([...this.files])}));const generalForm=document.querySelector(".general--details--form"),nameField=document.querySelector(".name__Field"),shopField=document.querySelector(".shopname__Field"),locationField=document.querySelector(".location__Field"),nameMsg=document.querySelector(".name__error__msg"),shopMsg=document.querySelector(".shopname__error__msg"),locationMsg=document.querySelector(".location__error__msg"),generalFormMsg=document.querySelector(".general__form__error__msg"),generalFormUpdateMsg=(e,t)=>{generalFormMsg.textContent=e,generalFormMsg.style.color=t};generalForm.addEventListener("submit",(e=>{if(e.preventDefault(),nameField.value.length<5||nameField.value.length>100)return void(nameMsg.textContent="name should contain 5 to 100 characters");if(shopField.value.length>200)return void(shopMsg.textContent="shopname should contain upto 200 characters");if(locationField.value.length>100)return void(locationMsg.textContent="location should contain upto 100 characters");(async()=>{const e=JSON.stringify({name:nameField.value,shop:shopField.value,location:locationField.value}),t=new Request("/updateGeneralInfo",{mode:"same-origin",method:"post",body:e,headers:{"Content-Type":"application/json"},cache:"no-cache"}),a=await fetch(t);if(200===a.status)return a.json();generalFormUpdateMsg("Your details has not updated","hsl(5, 100%, 50%)")})().then((()=>generalFormUpdateMsg("Your details has been updated","hsl(220,100%,55%)"))).catch((()=>generalFormUpdateMsg("Sorry something went wrong","hsl(5,100%,50%)")))}));
//# sourceMappingURL=updateProfile.js.map
